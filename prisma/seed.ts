import { PrismaClient } from '@prisma/client';
import { process } from 'process';

const prisma = new PrismaClient();

async function main() {
    console.log('üå± Iniciando seed do banco de dados...');

    // Limpar dados existentes
    await prisma.assetRecord.deleteMany();
    await prisma.insurance.deleteMany();
    await prisma.movement.deleteMany();
    await prisma.allocation.deleteMany();
    await prisma.simulation.deleteMany();
    await prisma.client.deleteMany();

    // Criar 5 clientes baseados nas imagens fornecidas
    const clients = await Promise.all([
        prisma.client.create({
            data: {
                name: 'Matheus Silveira',
                email: 'matheus.silveira@email.com',
                phone: '(11) 99999-8888',
                address: 'Vila Ol√≠mpia, S√£o Paulo/SP',
                isActive: true
            }
        }),
        prisma.client.create({
            data: {
                name: 'Pedro Magalh√£es',
                email: 'pedro.magalhaes@email.com',
                phone: '(11) 88888-7777',
                address: 'Jardins, S√£o Paulo/SP',
                isActive: true
            }
        }),
        prisma.client.create({
            data: {
                name: 'Larissa Alves',
                email: 'larissa.alves@email.com',
                phone: '(11) 77777-6666',
                address: 'Moema, S√£o Paulo/SP',
                isActive: true
            }
        }),
        prisma.client.create({
            data: {
                name: 'Fernando Coelho',
                email: 'fernando.coelho@email.com',
                phone: '(11) 66666-5555',
                address: 'Itaim Bibi, S√£o Paulo/SP',
                isActive: true
            }
        }),
        prisma.client.create({
            data: {
                name: 'D√©bora Matto',
                email: 'debora.matto@email.com',
                phone: '(11) 55555-4444',
                address: 'Pinheiros, S√£o Paulo/SP',
                isActive: true
            }
        })
    ]);

    const client = clients[0]; // Matheus Silveira como cliente principal
    console.log('‚úÖ Clientes criados:', clients.map(c => c.name).join(', '));

    // Criar simula√ß√µes para Matheus Silveira (cliente principal)
    const originalPlan = await prisma.simulation.create({
        data: {
            name: 'Plano Original',
            startDate: new Date('2025-01-01'),
            realRate: 0.04,
            status: 'ATIVO',
            clientId: client.id,
            description: 'Plano original de investimentos'
        }
    });

    const currentSituation = await prisma.simulation.create({
        data: {
            name: 'Situa√ß√£o atual 05/2025',
            startDate: new Date('2025-05-01'),
            realRate: 0.04,
            status: 'SITUACAO_ATUAL',
            clientId: client.id,
            baseId: originalPlan.id,
            description: 'Situa√ß√£o atual baseada no plano original'
        }
    });

    const realized = await prisma.simulation.create({
        data: {
            name: 'Realizado',
            startDate: new Date('2025-01-01'),
            realRate: 0.04,
            status: 'REALIZADO',
            clientId: client.id,
            description: 'Dados realizados at√© o momento'
        }
    });

    // Criar simula√ß√µes para Pedro Magalh√£es
    const pedroOriginal = await prisma.simulation.create({
        data: {
            name: 'Plano original',
            startDate: new Date('2025-02-01'),
            realRate: 0.04,
            status: 'ATIVO',
            clientId: clients[1].id,
            description: 'Plano original do cliente Pedro'
        }
    });

    const pedroAposentadoria = await prisma.simulation.create({
        data: {
            name: 'Adiantar aposentadoria 3 anos',
            startDate: new Date('2025-03-01'),
            realRate: 0.04,
            status: 'ATIVO',
            clientId: clients[1].id,
            description: 'Simula√ß√£o com aposentadoria antecipada'
        }
    });

    const pedroPraia = await prisma.simulation.create({
        data: {
            name: 'Aposentadoria na praia',
            startDate: new Date('2025-04-01'),
            realRate: 0.04,
            status: 'ATIVO',
            clientId: clients[1].id,
            description: 'Simula√ß√£o para aposentadoria na praia'
        }
    });

    // Criar simula√ß√µes para Larissa Alves
    const larissaOriginal = await prisma.simulation.create({
        data: {
            name: 'Plano Original',
            startDate: new Date('2025-01-15'),
            realRate: 0.045,
            status: 'ATIVO',
            clientId: clients[2].id,
            description: 'Plano original da cliente Larissa'
        }
    });

    // Criar simula√ß√µes para Fernando Coelho
    const fernandoOriginal = await prisma.simulation.create({
        data: {
            name: 'Plano Original',
            startDate: new Date('2025-02-15'),
            realRate: 0.035,
            status: 'ATIVO',
            clientId: clients[3].id,
            description: 'Plano original do cliente Fernando'
        }
    });

    // Criar simula√ß√µes para D√©bora Matto
    const deboraOriginal = await prisma.simulation.create({
        data: {
            name: 'Plano Original',
            startDate: new Date('2025-03-01'),
            realRate: 0.05,
            status: 'ATIVO',
            clientId: clients[4].id,
            description: 'Plano original da cliente D√©bora'
        }
    });

    console.log('‚úÖ Simula√ß√µes criadas para todos os clientes');

    // Criar aloca√ß√µes para Matheus Silveira (baseado nas imagens)
    const cdbItau = await prisma.allocation.create({
        data: {
            type: 'FINANCIAL',
            name: 'CDB Banco Ita√∫',
            initialValue: 1000000,
            currentValue: 1000000,
            initialDate: new Date('2024-06-20'),
            simulationId: originalPlan.id
        }
    });

    const cdbC6 = await prisma.allocation.create({
        data: {
            type: 'FINANCIAL',
            name: 'CDB Banco C6',
            initialValue: 1000000,
            currentValue: 1000000,
            initialDate: new Date('2023-06-20'),
            simulationId: originalPlan.id
        }
    });

    const apartamentoVilaOlimpia = await prisma.allocation.create({
        data: {
            type: 'IMMOBILIZED',
            name: 'Apartamento Vila Ol√≠mpia',
            initialValue: 148666, // Valor atual pago
            currentValue: 148666,
            initialDate: new Date('2024-07-01'),
            installments: 200,
            interestRate: 0.08,
            simulationId: originalPlan.id
        }
    });

    const loja = await prisma.allocation.create({
        data: {
            type: 'IMMOBILIZED',
            name: 'Loja',
            initialValue: 1800000,
            currentValue: 1800000,
            initialDate: new Date('2023-04-20'),
            simulationId: originalPlan.id
        }
    });

    // Criar aloca√ß√µes para Pedro Magalh√£es
    await prisma.allocation.createMany({
        data: [
            {
                type: 'FINANCIAL',
                name: 'Tesouro Selic 2029',
                amount: 500000,
                currentValue: 500000,
                initialDate: new Date('2024-01-15'),
                simulationId: pedroOriginal.id
            },
            {
                type: 'IMMOBILIZED',
                name: 'Casa em Santos',
                amount: 800000,
                currentValue: 800000,
                initialDate: new Date('2023-08-10'),
                simulationId: pedroOriginal.id
            }
        ]
    });

    // Criar aloca√ß√µes para Larissa Alves
    await prisma.allocation.createMany({
        data: [
            {
                type: 'FINANCIAL',
                name: 'CDB XP Investimentos',
                amount: 750000,
                startDate: new Date('2024-03-20'),
                simulationId: larissaOriginal.id
            },
            {
                type: 'IMMOBILIZED',
                name: 'Apartamento Moema',
                amount: 1200000,
                startDate: new Date('2023-11-15'),
                simulationId: larissaOriginal.id
            }
        ]
    });

    // Criar aloca√ß√µes para Fernando Coelho
    await prisma.allocation.createMany({
        data: [
            {
                type: 'FINANCIAL',
                name: 'LCI Banco do Brasil',
                amount: 600000,
                startDate: new Date('2024-05-10'),
                simulationId: fernandoOriginal.id
            },
            {
                type: 'IMMOBILIZED',
                name: 'Escrit√≥rio Itaim Bibi',
                amount: 900000,
                startDate: new Date('2023-09-05'),
                simulationId: fernandoOriginal.id
            }
        ]
    });

    // Criar aloca√ß√µes para D√©bora Matto
    await prisma.allocation.createMany({
        data: [
            {
                type: 'FINANCIAL',
                name: 'Fundo DI',
                amount: 400000,
                startDate: new Date('2024-02-28'),
                simulationId: deboraOriginal.id
            },
            {
                type: 'IMMOBILIZED',
                name: 'Loja Pinheiros',
                amount: 650000,
                startDate: new Date('2023-12-01'),
                simulationId: deboraOriginal.id
            }
        ]
    });

    console.log('‚úÖ Aloca√ß√µes criadas para todos os clientes');

    // Criar registros de aloca√ß√£o para hist√≥rico
    await prisma.assetRecord.createMany({
        data: [
            // CDB Ita√∫ - registros mensais
            {
                allocationId: cdbItau.id,
                date: new Date('2024-06-20'),
                amount: 1000000,
                notes: 'Investimento inicial'
            },
            {
                allocationId: cdbItau.id,
                date: new Date('2024-12-20'),
                amount: 1050000,
                notes: 'Atualiza√ß√£o semestral'
            },
            {
                allocationId: cdbItau.id,
                date: new Date('2025-06-10'),
                amount: 1100000,
                notes: '√öltima atualiza√ß√£o'
            },
            // CDB C6 - registros
            {
                allocationId: cdbC6.id,
                date: new Date('2023-06-20'),
                amount: 1000000,
                notes: 'Investimento inicial'
            },
            {
                allocationId: cdbC6.id,
                date: new Date('2024-08-10'),
                amount: 1080000,
                notes: 'Atualiza√ß√£o anual'
            },
            // Apartamento Vila Ol√≠mpia - parcelas pagas
            {
                allocationId: apartamentoVilaOlimpia.id,
                date: new Date('2024-07-01'),
                amount: 148666,
                notes: '14 parcelas pagas de 200'
            },
            // Loja - atualiza√ß√£o √∫nica
            {
                allocationId: loja.id,
                date: new Date('2023-04-20'),
                amount: 1800000,
                notes: 'Atualiza√ß√£o √∫nica'
            }
        ]
    });

    console.log('‚úÖ Registros de aloca√ß√£o criados');

    // Criar movimenta√ß√µes para Matheus Silveira (baseado nas imagens)
    await prisma.movement.createMany({
        data: [
            // Heran√ßa
            {
                type: 'INCOME',
                amount: 220000,
                title: 'Heran√ßa',
                frequency: 'UNIQUE',
                startDate: new Date('2023-07-09'),
                endDate: new Date('2023-07-22'),
                category: 'HERANCA',
                simulationId: originalPlan.id
            },
            // Comiss√£o
            {
                type: 'INCOME',
                amount: 500000,
                title: 'Comiss√£o',
                frequency: 'ANNUAL',
                startDate: new Date('2023-07-09'),
                endDate: new Date('2023-07-22'),
                category: 'COMISSAO',
                simulationId: originalPlan.id
            },
            // Custo do filho
            {
                type: 'EXPENSE',
                amount: 1500,
                title: 'Custo do filho',
                frequency: 'MONTHLY',
                startDate: new Date('2023-07-09'),
                endDate: new Date('2043-07-22'),
                category: 'DEPENDENTE',
                simulationId: originalPlan.id
            },
            // Sal√°rio CLT
            {
                type: 'INCOME',
                amount: 15000,
                title: 'Sal√°rio CLT',
                frequency: 'MONTHLY',
                startDate: new Date('2025-01-01'),
                endDate: new Date('2030-12-31'),
                category: 'SALARIO',
                simulationId: originalPlan.id
            },
            // Sal√°rio aut√¥nomo (primeiro per√≠odo)
            {
                type: 'INCOME',
                amount: 5000,
                title: 'Sal√°rio aut√¥nomo',
                frequency: 'MONTHLY',
                startDate: new Date('2030-01-01'),
                endDate: new Date('2035-12-31'),
                category: 'SALARIO',
                simulationId: originalPlan.id
            },
            // Sal√°rio aut√¥nomo (segundo per√≠odo)
            {
                type: 'INCOME',
                amount: 35000,
                title: 'Sal√°rio aut√¥nomo',
                frequency: 'MONTHLY',
                startDate: new Date('2035-01-01'),
                endDate: new Date('2045-12-31'),
                category: 'SALARIO',
                simulationId: originalPlan.id
            },
            // Despesas mensais
            {
                type: 'EXPENSE',
                amount: 8000,
                title: 'Custo de vida',
                frequency: 'MONTHLY',
                startDate: new Date('2025-01-01'),
                endDate: new Date('2030-12-31'),
                category: 'CUSTO_VIDA',
                simulationId: originalPlan.id
            },
            {
                type: 'EXPENSE',
                amount: 12000,
                title: 'Custo de vida',
                frequency: 'MONTHLY',
                startDate: new Date('2030-01-01'),
                endDate: new Date('2040-12-31'),
                category: 'CUSTO_VIDA',
                simulationId: originalPlan.id
            },
            {
                type: 'EXPENSE',
                amount: 20000,
                title: 'Custo de vida',
                frequency: 'MONTHLY',
                startDate: new Date('2040-01-01'),
                endDate: new Date('2045-12-31'),
                category: 'CUSTO_VIDA',
                simulationId: originalPlan.id
            },
            {
                type: 'EXPENSE',
                amount: 10000,
                title: 'Custo de vida',
                frequency: 'MONTHLY',
                startDate: new Date('2045-01-01'),
                endDate: new Date('2050-12-31'),
                category: 'CUSTO_VIDA',
                simulationId: originalPlan.id
            },
            {
                type: 'EXPENSE',
                amount: 15000,
                title: 'Custo de vida',
                frequency: 'MONTHLY',
                startDate: new Date('2050-01-01'),
                endDate: new Date('2060-12-31'),
                category: 'CUSTO_VIDA',
                simulationId: originalPlan.id
            }
        ]
    });

    // Criar movimenta√ß√µes para Pedro Magalh√£es
    await prisma.movement.createMany({
        data: [
            {
                type: 'INCOME',
                amount: 12000,
                title: 'Sal√°rio',
                frequency: 'MONTHLY',
                startDate: new Date('2025-01-01'),
                endDate: new Date('2035-12-31'),
                category: 'SALARIO',
                simulationId: pedroOriginal.id
            },
            {
                type: 'EXPENSE',
                amount: 6000,
                title: 'Custo de vida',
                frequency: 'MONTHLY',
                startDate: new Date('2025-01-01'),
                endDate: new Date('2060-12-31'),
                category: 'CUSTO_VIDA',
                simulationId: pedroOriginal.id
            }
        ]
    });

    // Criar movimenta√ß√µes para Larissa Alves
    await prisma.movement.createMany({
        data: [
            {
                type: 'INCOME',
                amount: 18000,
                title: 'Sal√°rio',
                frequency: 'MONTHLY',
                startDate: new Date('2025-01-01'),
                endDate: new Date('2040-12-31'),
                category: 'SALARIO',
                simulationId: larissaOriginal.id
            },
            {
                type: 'EXPENSE',
                amount: 10000,
                title: 'Custo de vida',
                frequency: 'MONTHLY',
                startDate: new Date('2025-01-01'),
                endDate: new Date('2060-12-31'),
                category: 'CUSTO_VIDA',
                simulationId: larissaOriginal.id
            }
        ]
    });

    // Criar movimenta√ß√µes para Fernando Coelho
    await prisma.movement.createMany({
        data: [
            {
                type: 'INCOME',
                amount: 20000,
                title: 'Sal√°rio',
                frequency: 'MONTHLY',
                startDate: new Date('2025-01-01'),
                endDate: new Date('2045-12-31'),
                category: 'SALARIO',
                simulationId: fernandoOriginal.id
            },
            {
                type: 'EXPENSE',
                amount: 12000,
                title: 'Custo de vida',
                frequency: 'MONTHLY',
                startDate: new Date('2025-01-01'),
                endDate: new Date('2060-12-31'),
                category: 'CUSTO_VIDA',
                simulationId: fernandoOriginal.id
            }
        ]
    });

    // Criar movimenta√ß√µes para D√©bora Matto
    await prisma.movement.createMany({
        data: [
            {
                type: 'INCOME',
                amount: 16000,
                title: 'Sal√°rio',
                frequency: 'MONTHLY',
                startDate: new Date('2025-01-01'),
                endDate: new Date('2038-12-31'),
                category: 'SALARIO',
                simulationId: deboraOriginal.id
            },
            {
                type: 'EXPENSE',
                amount: 8000,
                title: 'Custo de vida',
                frequency: 'MONTHLY',
                startDate: new Date('2025-01-01'),
                endDate: new Date('2060-12-31'),
                category: 'CUSTO_VIDA',
                simulationId: deboraOriginal.id
            }
        ]
    });

    console.log('‚úÖ Movimenta√ß√µes criadas para todos os clientes');

    // Criar seguros para Matheus Silveira (baseado nas imagens)
    await prisma.insurance.createMany({
        data: [
            {
                type: 'LIFE',
                name: 'Seguro de Vida Familiar',
                startDate: new Date('2025-01-01'),
                duration: 180, // 15 anos
                premium: 120,
                insuredValue: 500000,
                simulationId: originalPlan.id
            },
            {
                type: 'DISABILITY',
                name: 'Seguro de Invalidez',
                startDate: new Date('2025-01-01'),
                duration: 60, // 5 anos
                premium: 300,
                insuredValue: 100000,
                simulationId: originalPlan.id
            }
        ]
    });

    // Criar seguros para outros clientes
    await prisma.insurance.createMany({
        data: [
            // Pedro Magalh√£es
            {
                type: 'LIFE',
                name: 'Seguro de Vida',
                startDate: new Date('2025-02-01'),
                duration: 120, // 10 anos
                premium: 200,
                insuredValue: 300000,
                simulationId: pedroOriginal.id
            },
            // Larissa Alves
            {
                type: 'LIFE',
                name: 'Seguro de Vida',
                startDate: new Date('2025-01-15'),
                duration: 240, // 20 anos
                premium: 150,
                insuredValue: 400000,
                simulationId: larissaOriginal.id
            },
            {
                type: 'DISABILITY',
                name: 'Seguro de Invalidez',
                startDate: new Date('2025-01-15'),
                duration: 120, // 10 anos
                premium: 250,
                insuredValue: 200000,
                simulationId: larissaOriginal.id
            },
            // Fernando Coelho
            {
                type: 'LIFE',
                name: 'Seguro de Vida',
                startDate: new Date('2025-02-15'),
                duration: 180, // 15 anos
                premium: 180,
                insuredValue: 350000,
                simulationId: fernandoOriginal.id
            },
            // D√©bora Matto
            {
                type: 'LIFE',
                name: 'Seguro de Vida',
                startDate: new Date('2025-03-01'),
                duration: 300, // 25 anos
                premium: 100,
                insuredValue: 250000,
                simulationId: deboraOriginal.id
            }
        ]
    });

    console.log('‚úÖ Seguros criados para todos os clientes');

    console.log('üéâ Seed conclu√≠do com sucesso!');
    console.log('\nüìä Dados criados:');
    console.log(`- Clientes: 5 (Matheus Silveira, Pedro Magalh√£es, Larissa Alves, Fernando Coelho, D√©bora Matto)`);
    console.log(`- Simula√ß√µes: 8 (3 para Matheus + 1 para cada outro cliente)`);
    console.log(`- Aloca√ß√µes: 12 (4 para Matheus + 2 para cada outro cliente)`);
    console.log(`- Registros de aloca√ß√£o: 7 (hist√≥rico de aloca√ß√µes)`);
    console.log(`- Movimenta√ß√µes: 15 (11 para Matheus + 2 para cada outro cliente)`);
    console.log(`- Seguros: 7 (2 para Matheus + 1-2 para cada outro cliente)`);
}

main()
    .catch((e) => {
        console.error('‚ùå Erro no seed:', e);
        process.exit(1);
    })
    .finally(async () => {
        await prisma.$disconnect();
    });